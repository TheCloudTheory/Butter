trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

steps:
- task: NodeTool@0
  inputs:
    versionSpec: '10.x'
  displayName: 'Install Node.js'

- script: |
    npm install
    npm run build
  displayName: 'npm install and build'
  workingDirectory: 'Butter.Web'

- task: CopyFiles@2
  inputs:
    SourceFolder: 'Butter.Web'
    Contents: |
      dist/*.js
      style/*.css
      index.html
    TargetFolder: 'Web'
    CleanTargetFolder: true

- task: PublishBuildArtifacts@1
  inputs:
    PathtoPublish: 'Web'
    ArtifactName: 'web'
    publishLocation: 'Container'

- task: DotNetCoreCLI@2
  inputs:
    command: 'build'
    projects: 'Butter.Backend/Butter.Backend.csproj'
